# Sistema de Boletos IMED - .htaccess ATUALIZADO
# Arquivo: .htaccess (ADICIONAR estas linhas no início)

# Redirecionamento específico para Breu Branco
RewriteEngine On

# Regra específica para busca de cursos do Breu Branco
RewriteCond %{QUERY_STRING} polo=breubranco\.imepedu\.com\.br
RewriteRule ^admin/api/buscar-cursos\.php$ /admin/api/buscar-cursos-breubranco-especifico.php [L,QSA]

# Resto das regras originais...
RewriteBase /

# Força HTTPS (descomente em produção)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Headers de segurança
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # CORS para API
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization"
</IfModule>

# URLs amigáveis - rotas específicas do sistema
RewriteRule ^login/?$ login.php [L]
RewriteRule ^logout/?$ logout.php [L]
RewriteRule ^dashboard/?$ dashboard.php [L]
RewriteRule ^admin/?$ admin/dashboard.php [L]
RewriteRule ^boleto/([0-9]+)/?$ boleto.php?id=$1 [L]

# API routes
RewriteRule ^api/atualizar-dados/?$ api/atualizar_dados.php [L]
RewriteRule ^api/([a-zA-Z_]+)/?$ api/$1.php [L]

# Remove .php das URLs para arquivos públicos
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !^/api/
RewriteCond %{REQUEST_URI} !^/(config|src|logs|vendor)/
RewriteRule ^([^\.]+)$ $1.php [NC,L]

# Página inicial
DirectoryIndex index.php

# Resto da configuração original...